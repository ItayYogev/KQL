union DeviceTvmSoftwareVulnerabilities, CloudAppEvents
| join kind=inner (DeviceTvmSoftwareVulnerabilitiesKB) on CveId
| where SoftwareName contains "windows_10" or SoftwareName contains "mac_os" or SoftwareName contains "windows_11"
| where VulnerabilitySeverityLevel in ("Medium", "High", "Critical", "Low")
| summarize UniqueCveCount = dcount(CveId1) by VulnerabilitySeverityLevel
| render columnchart 